/* ===================================
   Cosmic Card Component
   Reusable card with gradient borders, glow effects, and sparkle patterns
   =================================== */

.cosmic-card {
  /* Color system - customizable per level */
  --cosmic-color: var(--accent);
  --cosmic-ink: var(--text-primary);
  --cosmic-surface-top: color-mix(
    in srgb,
    var(--glass-bg) 82%,
    var(--cosmic-color) 18%
  );
  --cosmic-surface-bottom: color-mix(
    in srgb,
    var(--glass-bg) 92%,
    var(--cosmic-color) 8%
  );
  --cosmic-inner-stroke: color-mix(in srgb, var(--cosmic-ink) 12%, transparent);
  --cosmic-glow-a: color-mix(in srgb, var(--cosmic-color) 42%, transparent);
  --cosmic-glow-b: color-mix(in srgb, var(--cosmic-color) 34%, transparent);
  --cosmic-glow-c: color-mix(in srgb, var(--cosmic-color) 28%, transparent);
  --cosmic-stars-opacity: 0.22;
  --cosmic-stars-blend: screen;

  /* Layout */
  position: relative;
  display: block;
  overflow: hidden;
  border-radius: var(--radius-lg);
  padding: var(--space-5);

  /* Gradient border effect */
  border: 1px solid var(--divider);
  background: var(--surface-1);

  /* Glow layers */
  box-shadow: var(--shadow-sm);

  transition:
    transform 0.3s ease,
    box-shadow 0.3s ease;
}

/* Glow overlays (::before) - 3 radial gradients for ambient glow */
.cosmic-card::before {
  display: none;
}

/* Sparkle pattern (::after) - 8 radial gradients for star effect */
.cosmic-card::after {
  display: none;
}

/* Ensure content appears above pseudo-elements */
.cosmic-card > * {
  position: relative;
  z-index: 1;
}

/* Hover state - enhanced glow */
.cosmic-card:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-md);
  border-color: var(--cosmic-color);
}

/* ===================================
   Level Modifiers
   =================================== */

.cosmic-card--vision {
  --cosmic-color: var(--level-vision, #8b5cf6);
  --cosmic-border-gradient: linear-gradient(135deg, #8b5cf6 0%, #a78bfa 120%);
}

.cosmic-card--milestone {
  --cosmic-color: var(--level-milestone, #3b82f6);
  --cosmic-border-gradient: linear-gradient(135deg, #3b82f6 0%, #60a5fa 120%);
}

.cosmic-card--focus {
  --cosmic-color: var(--level-focus, #f59e0b);
  --cosmic-border-gradient: linear-gradient(135deg, #f59e0b 0%, #fbbf24 120%);
}

.cosmic-card--intention {
  --cosmic-color: var(--level-intention, #10b981);
  --cosmic-border-gradient: linear-gradient(135deg, #10b981 0%, #6ee7b7 120%);
}

/* Inherited accent (Vision color) */
.cosmic-card[data-link-accent="1"] {
  --cosmic-color: var(--link-accent, var(--cosmic-color));
  --cosmic-border-gradient: var(
    --link-accent-gradient,
    linear-gradient(
      135deg,
      color-mix(in srgb, var(--link-accent, var(--cosmic-color)) 92%, white 8%)
        0%,
      color-mix(in srgb, var(--link-accent, var(--cosmic-color)) 62%, white 38%)
        120%
    )
  );
}

/* ===================================
   Internal Components
   =================================== */

/* Header (contains label and count badge) */
.cosmic-card-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: var(--space-3, 12px);
  position: relative;
  z-index: 1;
}

/* Level label (emoji + text) */
.cosmic-card-label {
  display: inline-flex;
  align-items: center;
  gap: var(--space-2, 8px);
  font-family: var(
    --font-display,
    -apple-system,
    BlinkMacSystemFont,
    "Segoe UI",
    sans-serif
  );
  font-size: var(--text-xl, 1.25rem);
  font-weight: 850;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: color-mix(in srgb, var(--cosmic-ink) 86%, transparent);
}

/* Emoji with drop shadow */
.cosmic-card-emoji {
  font-size: 1.5rem;
  filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2));
}

/* Label text */
.cosmic-card-label-text {
  line-height: 1;
}

/* Count badge */
.cosmic-card-count {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 32px;
  height: 32px;
  padding: 0 12px;
  border-radius: var(--radius-full, 9999px);
  background: color-mix(in srgb, var(--cosmic-ink) 10%, transparent);
  border: 1px solid color-mix(in srgb, var(--cosmic-ink) 16%, transparent);
  color: color-mix(in srgb, var(--cosmic-ink) 82%, transparent);
  font-size: var(--text-sm, 0.875rem);
  font-weight: 700;
}

/* Content area */
.cosmic-card-content {
  position: relative;
  z-index: 1;
}

/* Goal list container */
.cosmic-goal-list {
  display: flex;
  flex-direction: column;
  gap: var(--space-2, 8px);
  position: relative;
  z-index: 1;
}

/* Individual goal item */
.cosmic-goal-item {
  width: 100%;
  text-align: left;
  padding: var(--space-3, 12px) var(--space-4, 16px);
  border-radius: var(--radius-md, 12px);
  border: 1px solid color-mix(in srgb, var(--cosmic-ink) 12%, transparent);
  background: color-mix(in srgb, var(--cosmic-ink) 4%, transparent);
  color: var(--cosmic-ink);
  font-size: var(--text-base, 1rem);
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  display: block;
}

.cosmic-goal-item:hover {
  background: color-mix(in srgb, var(--cosmic-ink) 8%, transparent);
  border-color: color-mix(in srgb, var(--cosmic-color) 40%, transparent);
  transform: translateX(4px);
}

.cosmic-goal-item:active {
  transform: translateX(2px) scale(0.99);
}

/* Empty state */
.cosmic-empty-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  padding: var(--space-5, 20px) var(--space-4, 16px);
  position: relative;
  z-index: 1;
}

.cosmic-empty-icon {
  font-size: 4rem;
  margin-bottom: var(--space-4, 16px);
  opacity: 0.4;
  filter: drop-shadow(0 2px 8px rgba(0, 0, 0, 0.1));
}

.cosmic-empty-message {
  font-size: var(--text-base, 1rem);
  color: var(--text-secondary);
  margin-bottom: var(--space-6, 24px);
  line-height: 1.6;
  max-width: 300px;
}

.cosmic-add-btn {
  display: inline-flex;
  align-items: center;
  gap: var(--space-2);
  padding: var(--space-2) var(--space-4);
  background: var(--cosmic-color);
  color: white;
  border: none;
  border-radius: var(--radius-md);
  font-size: var(--text-sm);
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
  box-shadow: var(--shadow-sm);
}

.cosmic-add-btn:hover {
  background: color-mix(in srgb, var(--cosmic-color) 90%, white);
  transform: scale(1.05);
  box-shadow: 0 4px 12px
    color-mix(in srgb, var(--cosmic-color) 50%, transparent);
}

.cosmic-add-btn:active {
  transform: scale(0.98);
}

.cosmic-add-icon {
  font-size: 1.25rem;
  font-weight: 700;
  line-height: 1;
}

/* ===================================
   Dark Mode Adjustments
   =================================== */

html.dark-mode .cosmic-card {
  --cosmic-stars-opacity: 0.32;
}

html.dark-mode .cosmic-card::before {
  opacity: 1.1;
}

/* ===================================
   Responsive - Mobile
   =================================== */

@media (max-width: 900px) {
  .cosmic-card {
    padding: var(--space-5, 20px);
  }

  /* Reduce cosmic effects on mobile for performance */
  .cosmic-card::before {
    opacity: 0.6;
  }

  .cosmic-card::after {
    opacity: calc(var(--cosmic-stars-opacity) * 0.6);
  }

  .cosmic-card-label {
    font-size: var(--text-lg, 1.125rem);
  }
}

/* ===================================
   Mini Variant (for Day View Sidebar)
   =================================== */

.cosmic-card--mini {
  padding: 8px 10px 9px;
  border-radius: 16px;
  min-height: unset;
  cursor: pointer;
}

.cosmic-card--mini::after {
  opacity: calc(var(--cosmic-stars-opacity) * 0.7);
}

.cosmic-card-header--mini {
  margin-bottom: 6px;
}

.cosmic-card-label--mini {
  font-size: 0.78rem;
  letter-spacing: 0.08em;
  justify-content: center;
  width: 100%;
}

.cosmic-card-label--mini .cosmic-card-emoji {
  display: none;
}

.cosmic-card-content--mini {
  margin-top: 0;
}

.cosmic-card-title {
  font-size: 1.05rem;
  font-weight: 600;
  font-style: italic;
  color: var(--cosmic-ink);
  text-align: center;
  line-height: 1.3;
  max-width: 100%;
  overflow: hidden;
  text-overflow: ellipsis;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
}

.cosmic-card--mini:hover {
  transform: translateY(-1px);
  box-shadow:
    0 0 0 1px var(--cosmic-inner-stroke) inset,
    var(--shadow-lg),
    0 0 22px var(--cosmic-glow-b),
    0 0 30px var(--cosmic-glow-a),
    0 0 18px var(--cosmic-glow-c);
}

.cosmic-card--mini:focus-visible {
  outline: 3px solid color-mix(in srgb, var(--cosmic-color) 70%, transparent);
  outline-offset: 4px;
}

/* Context goals container for mini cards */
.context-goals--mini {
  display: flex;
  align-items: center;
  gap: var(--space-2, 8px);
}

.context-more {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 4px 8px;
  border-radius: var(--radius-full, 9999px);
  background: color-mix(in srgb, var(--accent) 20%, transparent);
  color: var(--text-secondary);
  font-size: var(--text-sm, 0.875rem);
  font-weight: 600;
}

.cosmic-card--mini + .context-more {
  background: color-mix(in srgb, var(--cosmic-color) 20%, transparent);
  color: var(--cosmic-ink);
}

/* ===================================
   Accessibility - Reduced Motion
   =================================== */

@media (prefers-reduced-motion: reduce) {
  .cosmic-card,
  .cosmic-card:hover,
  .cosmic-goal-item,
  .cosmic-add-btn {
    transition: none;
    transform: none !important;
  }

  .cosmic-card::before,
  .cosmic-card::after {
    animation: none;
  }
}
